<html>
<head>
<title>How to use DoseUtility&trade;</title>
</head>
<body>
<table width="100%">
<tr>
<td><img SRC="images/PixelMedLogoAndTitle.gif" ALT="PixelMed Publishing&trade;" BORDER=0></td>
<td><A HREF="http://www.opensource.org/"><IMG SRC="images/osi_standard_logo.png" width="90" height="103" border="0"/></A></td>
</tr>
</table>
<hr/>
<table>
<tr>
<td><a href="DoseUtility.html"><IMG SRC="images/DoseUtilityMainPanel.png" BORDER=0/></a></td>
</tr>
</table>
<hr/>
<a href="DoseUtility.html"><IMG SRC="icons/DoseUtility.png" ALT="Click here to start the DoseUtility&trade;" BORDER=0/></a>
<a name="Description"><h1>What is <a href="DoseUtility.html">DoseUtility&trade;</a>?</h1></a>
<p><a href="DoseUtility.html">DoseUtility&trade;</a> is a free open source tool with a user interface to query, retrieve, import, and extract and report radiation dose information.
It is written in pure Java, will run on any platform and can be started from the web without local installation. It can:</p>
<ul>
<li>Import files from a CD or the local hard drive or a shared network drive or any other media, with or without a DICOMDIR</li>
<li>Query and selectively retrieve dose information or entire CT series from remote DICOM devices</li>
<li>Extract the dose information from a GE or Siemens or Toshiba CT screen saved image using Optical Character Recognition (OCR)</li>
<li>Extract the dose information from a Philips CT screen save or localizer image using the proprietary Standard Extended SOP Class Exposure Dose Sequence information in the "header"</li>
<li>Generate Radiation Dose Structured Reports (RDSRs) from such extracted dose information</li>
<li>View the contents of dose screen save images and RDSRs</li>
<li>Tabulate the contents of dose screen save images and RDSRs for multiple patients and studies</li>
<li>Validate the content and structure of RDSRs</li>
<li>Submit de-identified RDSRs to Dose Registries (using the Submit Dose Information transaction of the <a href="http://wiki.ihe.net/index.php?title=Radiation_Exposure_Monitoring">IHE Radiation Exposure Monitoring (REM) profile</a></li>
</ul>
<a name="ScreenImages"><h2>How do I query, retrieve and extract dose information from screen images?</h2></a>
<p>Having configured the network targets appropriately (see below), one can enter various query keys and obtain from the PACS a list of studies for one or more patients,
which will be displayed as a tree in the left panel.</p>
<p>One can then select either everything returned by the query (top node in the tree), or a single study or series to retrieve. Initially,
one may leave the "Retrieve only dose series" box checked to reduce the volume of material retrieved.</p>
<p>The retrieved instances will be listed in the right panel, and can be explored by expanding the tree.</p>
<p>The following example shows a CT study that contains not only a dose screen save image, but also a radiation dose report.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityMainPanel.png"/></td>
</tr>
</table>
</center>
<p>If any GE or Siemens or Toshiba or Philips CT Dose screen save images are present, one can select the image and press the View button to show its contents.
The GE dose screens are usually in Series 999; the Siemens dose screens are usually in Series 501; the Toshiba dose screens may be in Series 1000,
or in any series (and hence can be hard to find), and may span multiple pages (multiple images);
the Philips dose screens are usually in Series 1 and have a Series Description of "Dose Info",
though sometimes the dose screen is absent and the dose information is present inside the localizer.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityDoseScreenImage.png"/></td>
</tr>
</table>
</center>
<p>One can also press the Report button to perform OCR or process the "header" as required, and extract the information in a tabular form in a new popup window.
The "Show only dose summary" checkbox can be turned off prior to pressing Report in order to show the per-series information, as in the following screenshot:</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityLogOfReport.png"/></td>
</tr>
</table>
</center>
<p>Reports about multiple studies can be generated at the same time if one selects higher in the tree in the right panel, as in the following screenshot:</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityLogOfReportMultiple.png"/></td>
</tr>
</table>
</center>
<p>Note that when entire patients or studies are selected, and the studies contain both dose screens and RDSRs (whether generated by the modality, or this tool), then there will be multiple entries in the resulting report.</p>
<p>Detailed information about the acquisition parameters related to dose that is not included in the dose screen save or its header can be obtained if one unchecks the "Retrieve only dose series" box,
then retrieves the entire set of CT images for the studies, and then generates the report again after unchecking the "Process only dose series" box ... this will be slower, of course, but results in more complete information,
similar to what one might find in a Radiation Dose SR report. This may also help if the query is unable to find any dose screens using the series level information (e.g., if dose screens
have been lumped into series with localizers, or the PACS database has coerced the series level description into something unexpected).</p>
<p>A textual rather than tabular form of report may be obtained by unchecking the "Show tabular layout in report" checkbox. The tabular form is implemented using HTML tables,
and can be cut-and-pasted into other tools using mouse selection and the conventional key board shortcuts for the platform (e.g., ctrl-A, ctrl-C, ctrl-V for Windows to cut-and-paste everything).</p>

<a name="DoseSR_QRE"><h2>How do I query, retrieve and extract dose information from Radiation Dose SR instances?</h2></a>
<p>Any SR instances present, including Radiation Dose SR instances, are also retrieved, even when the "Retrieve only dose series" box is checked, and will be listed in the right panel, and can be explored by expanding the tree.</p>
<p>Their contents will be included in the output of the Report button. E.g., if there is both an RDSR and a Dose Screen, then the information from both will be reported.</p>
<p>The more detailed structured content may be explored by pressing the View button, which will pop up a hierarchical tree browser of the content.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityDoseSRTree.png"/></td>
</tr>
</table>
</center>
<p>The RDSR structure and contents may be validated by pressing the Validate button. For illustrative purposes, this example shows
a prototype SR file that is not correct and is encoded in an Enhanced SR SOP Class rather than the Radiation Dose SR SOP Class:</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityDoseSRValidation.png"/></td>
</tr>
</table>
</center>
<p>Whether or not the validation is case-sensitive with respect to checking code meanings can be controlled by a checkbox. This is sometimes useful to reduce the verbosity of
the output caused by variations in the capitalization of the word "X-Ray" (see <a href="http://www.dclunie.com/dicom-status/status.html#CP1069">DICOM CP 1069</a>).</p>

<a name="DoseSR_Generate"><h2>How do I generate Radiation Dose SR instances from extracted dose information?</h2></a>
<p>Radiation Dose SR files can be generated from the extracted dose information for the selected patient, study, series or dose screen instance with the "Make RDSR" button.</p>
<p>The amount
of information included (and hence the validity of the resulting object), will depend on whether or not the "Process only dose series" box is selected and the level of the selection
in the tree. Unchecking this box and selecting at the Study level or higher will generate include as much information as possible, including the required technique information
for each acquisition extracted from the axial images.</p>
<p>The resulting RDSR instances will be added as a new Series 897 with a description of "Radiation Dose Information".</p>
<p>Any existing RDSR instances (whether from the modality, created by another application, or generated by this tool) will be ignored during this process.</p>

<a name="Registry"><h2>How do I send Radiation Dose SR instances to a Dose Registry, or elsewhere?</h2></a>
<p>RDSR files (whether from the modality, created by another application, or generated by this tool) for the entire database or the selected patient, study, series or
dose screen instances can be submitted to a pre-configured Dose Registry with the "->Registry" button.</p>
<p>By default, these are de-identified as they are being sent, which means
that patient identity information such as names and medical record numbers are removed. The UIDs, device identity and institution identity are preserved, since registries
track by facility and device and need to be able to detect duplicate submissions. A check-box allows the de-identification to be turned off if appropriate (e.g., submitting
to a service such as an EHR that tracks patient exposure over time).</p>
<p>RDSR files can also be sent to a a pre-configured DICOM network storage SCP with the "->Dicom" button, for example to return newly-generated RDSRs back to the PACS from
whence the study was retrieved. Only RDSRs are sent, not the images or other objects.</p>

<a name="Usage"><h2>How to start it</h2></a>
<p><a href="DoseUtility.html">DoseUtility&trade;</a> is a Java Web Start (JWS) application that you can run from within a web browser. It runs on any platform that supports Java 1.7 or greater,
and does not require any "installation" per se. Just click on the <a href="DoseUtility.html">DoseUtility&trade;</a> link, and confirm all security requests to run the application.
Java must not be disabled in your browser (check browser security settings). 
If Java is not already installed, you may be prompted to install it or allow automatic installation to proceed. After Java installation, you may need to reload the link to get
the application to start.
In Internet Explorer, you may have to disable the Protected Mode (for some versions, e.g., IE 8, but not IE 11) and use the default Medium-High rather than High Security level; to eliminate a download file prompt, you can enable Automatic prompting for file downloads in the Custom Level Security settings.
MacOS Safari will no longer run JWS automatically; you will have to double-click the JNLP file in the Downloads window (or use any other Mac browser instead).</p>
<p>Whenever you use the web start application, it will automatically check for the
latest version on the web site and use that, so you never need to be concerned about upgrading or maintenance.</p>
<p>If you like, you can right-click on the <a href="DoseUtility.html">link</a> to save it as a Windows Desktop Shortcut to make it as easy to start up as any other application, but this is not required, since you can always start it from a browser.
If you make such a shortcut, you can give it an icon by downloading <a href="http://www.dclunie.com/pixelmed/software/webstart/icons/DoseUtility.ico">this Windows icon (.ico) file</a>, and right-clicking the shortcut and selecting its Properties, and browsing to the downloaded .ico file.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityCopyShortcut.png"/></td>
<td><IMG SRC="images/DoseUtilityPasteShortcut.png"/></td>
<td><IMG SRC="images/DoseUtilityShortcutIconInstalled.png"/></td>
</tr>
</table>
</center>
<p>You can do something similar on the Mac by dragging this <a href="DoseUtility.html">link</a> to the Desktop, and can give it an icon using the Get Info (Cmd-I) dialog, renaming the file to "DoseUtility.fileloc" and downloading <a href="http://www.dclunie.com/pixelmed/software/webstart/icons/DoseUtility.png">this PNG file</a> and dragging it on top of the icon in the dialog.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityMacShortcutIconDragged.png"/></td>
<td><IMG SRC="images/DoseUtilityMacShortcutDialog.png"/></td>
<td><IMG SRC="images/DoseUtilityMacShortcutDialogWithNameAndIcon.png"/></td>
<td><IMG SRC="images/DoseUtilityMacShortcutIconInstalled.png"/></td>
</tr>
</table>
</center>

<a name="Configuration"><h2>Configuration</h2></a>
<a name="ConfigurationDicom"><h3>DICOM</h3></a>
<p>If you want to use a DICOM network (rather than importing from or exporting to folders and files), you can use the "Configure" button to enter information
about remote DICOM network devices and the port and AET of the DoseUtility&trade; itself.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityLocalConfiguration.png"/></td>
<td><IMG SRC="images/DoseUtilityRemoteConfiguration.png"/></td>
</tr>
</table>
</center>
<p>This information will be saved in a properties files located in
the user's home directory, called ".com.pixelmed.apps.DoseUtility.properties", so that you do not have to re-enter it next time. The
property file can also be created or edited manually, though any comments will be lost when the "Configure" button in the user interface is used to
update it. The application also supports DNS self-discovery of other DICOM applications, though this is not widely deployed.</p>
<a name="ConfigurationFtp"><h3>FTP</h3></a>
<p>After the DICOM configuration information has been entered or edited, another dialog will appear to configure the FTP information of Dose Registries to which RDSRs may be sent. Just press Done if no registries need to be configured, or add the secure FTP parameters as required.</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityLocalFTPConfiguration.png"/></td>
<td><IMG SRC="images/DoseUtilityRemoteFTPConfiguration.png"/></td>
</tr>
</table>
</center>

<a name="Installation"><h2>How to install it (locally)</h2></a>
<p>If for some reason you do not want to start the application using Java Web Start, but instead want to download it and install it, several versions are available:</p>
<ul>
<li><a href="http://www.dclunie.com/pixelmed/software/winexe/DoseUtilityWithOwnJRE.zip">Windows executable that does not require Java to be installed</a> [approx. 45 MB] (includes its own JRE, internationalized fonts, and JIIO libraries)</li>
<li><a href="http://www.dclunie.com/pixelmed/software/winexe/DoseUtilityAssumingJREInstalled.zip">Windows executable that requires Java 1.7 or later to already be installed</a> [approx. 3.9 MB] (includes its own  JIIO libraries, since these are often not installed)</li>
<li><a href="http://www.dclunie.com/pixelmed/software/macexe/DoseUtilityMac.zip">MacOS executable that requires Java 1.7 or later to already be installed</a> [approx. 2.1 MB] (includes pure Java JIIO libraries for limited decompression support)</li>
</ul>
<p>The downloaded installable version does NOT automatically update when new versions are released, however.</p>
<p>If you need to report a problem, and want to know what version you are using, look at the status bar immediately after starting the application:</p>
<center>
<table>
<tr>
<td><IMG SRC="images/DoseUtilityShowVersion.png"/></td>
</tr>
</table>
</center>

<a name="SourceCode"><h2>Where is the source code?</h2></a>
<p>The open source code is contained within the <a href="http://www.dclunie.com/pixelmed/software/index.html">PixelMed&trade; toolkit</a>.</p>

<hr/>
<a name="OtherTools"><h2>What other PixelMed&trade; dose tools are available?</h2></a>
<p>The toolkit contains a number of other utilities that may be useful, including:</p>
<ul>
<li><a href="http://www.dclunie.com/pixelmed/software/javadoc/com/pixelmed/apps/DoseReporterWithLegacyOCRAndAutoSendToRegistry.html">com.pixelmed.apps.DoseReporterWithLegacyOCRAndAutoSendToRegistry</a> - A class to wait for incoming dose screen images and SRs and send them to pre-configured registry, and to regularly poll a DICOM SCP (like a PACS) to retrieve dose screens and SRs</li>
<li><a href="http://www.dclunie.com/pixelmed/software/javadoc/com/pixelmed/doseocr/LegacyRadiationDoseOCRDicomForwardingService.html">com.pixelmed.doseocr.LegacyRadiationDoseOCRDicomForwardingService</a> - A class to wait for incoming dose screen images, perform OCR to create Radiation Dose SRs and send RDSRs to a pre-configured DICOM destination.</li>
</ul>

<hr/>
<a href="DoseUtility.html"><IMG SRC="icons/DoseUtility.png" ALT="Click here to start the DoseUtility&trade;" BORDER=0/></a>
<p></a>Click here to start the <a href="DoseUtility.html">DoseUtility&trade;</a>.</p>
</body>
</html>
